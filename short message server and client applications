#include <sys/socket.h>
#include <sys/types.h>
#include <netinet/in.h>
#include <netdb.h>

#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <unistd.h>
#include <errno.h>
#include <ctype.h>
#include <fcntl.h>
#include <sys/ioctl.h>

#define PORT 1080
#define BUF_LEN  2000
#define STDIN 0
#define SADDR "127.0.0.1"
#define TV_SEC 10


void test_fds(fd_set testfds, int sock) {
int nread;
char buffer[BUF_LEN];

  if (FD_ISSET(STDIN, &testfds)) {
ioctl(STDIN,FIONREAD,&nread);
if (nread == 0) {
        printf("Keyboard done!\n");
  exit(0);
}
        nread = read(STDIN, buffer, nread);
buffer[nread] = '\0';
write(sock, buffer, nread);
      }

      if (FD_ISSET(sock, &testfds)) {
ioctl(sock,FIONREAD,&nread);
if (nread == 0) {
        printf("Socket done!\n");
  exit(0);
}
        nread = read(sock, buffer, nread);
buffer[nread] = '\0';
        printf("%s", buffer);
      }
}

int main(int argc, char **argv)
{
    int sock, bytes_recieved;
    char send_data[BUF_LEN],recv_data[BUF_LEN];
    struct sockaddr_in server_addr;
    fd_set readfds,testfds;
    struct timeval tv;
int maxfd,stdeof,c,ret;
char *saddr = NULL, *sport = NULL;
